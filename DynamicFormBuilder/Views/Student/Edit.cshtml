@model Student

@using (Html.BeginForm("Edit", "Student", FormMethod.Post, new { id = "editStudentForm" }))
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(model => model.StudentId)

    <div class="form-group mb-3">
        <label>Full Name</label>
        @Html.TextBoxFor(model => model.StudentName, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.StudentName, "", new { @class = "text-danger" })
    </div>

    <div class="form-group mb-3">
        <label>Email</label>
        @Html.TextBoxFor(model => model.Email, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })
    </div>
    <div class="form-group mb-3">
        <label>Age</label>
        @Html.TextBoxFor(model => model.Age, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.Age, "", new { @class = "text-danger" })
    </div>

    <div class="form-group mb-3">
        <label>Department</label>
        @Html.TextBoxFor(model => model.Department, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.Department, "", new { @class = "text-danger" })
    </div>

    <div class="form-group mb-3">
        <label>Phone</label>
        @Html.TextBoxFor(model => model.PhoneNumber, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.PhoneNumber, "", new { @class = "text-danger" })
    </div>

    <div class="form-group mb-3">
        <label>Address</label>
        @Html.TextBoxFor(model => model.Address, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })
    </div>

    <div class="d-flex justify-content-end gap-2 mt-4">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-primary">Update</button>
    </div>
}

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
<script>
    $(document).ready(function() {
        $('#editStudentForm').submit(function(e) {
            e.preventDefault();

            if (!$(this).valid()) {
                return false;
            }

            $.ajax({
                url: $(this).attr('action'),
                type: 'POST',
                data: $(this).serialize(),
                headers: { 'X-Requested-With': 'XMLHttpRequest' },
                success: function(result) {
                    if (result.success) {
                        // Close modal
                        var modal = bootstrap.Modal.getInstance(document.getElementById('editStudentModal'));
                        modal.hide();

                        // Show success message
                        alert(result.message);

                        // Reload page to show updated data
                        location.reload();
                    } else {
                        // Reload form with validation errors
                        $('#editModalBody').html(result);
                    }
                },
                error: function() {
                    alert('Error updating student');
                }
            });
        });
    });
</script>