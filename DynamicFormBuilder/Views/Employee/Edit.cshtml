@* @model EmployeeModel

@{
    ViewData["Title"] = "Edit Employee";
}

<h2>Edit Employee</h2>

@using (Html.BeginForm("Edit", "Employee", FormMethod.Post))
{
    @Html.AntiForgeryToken()

    <!-- Hidden ID -->
    @Html.HiddenFor(model => model.Id)

    <div class="form-group">
        <label>Full Name</label>
        @Html.TextBoxFor(model => model.FullName, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.FullName)
    </div>
    <div class="form-group">
        <label>Full Name</label>
        @Html.TextBoxFor(model => model.EmployeeId, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.EmployeeId)
    </div>

    <div class="form-group">
        <label>Email</label>
        @Html.TextBoxFor(model => model.Email, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.Email)
    </div>

    <div class="form-group">
        <label>Designation</label>
        @Html.TextBoxFor(model => model.Designation, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.Designation)
    </div>

    <div class="form-group">
        <label>Date of Birth</label>
        @Html.TextBoxFor(model => model.DOB, "{0:yyyy-MM-dd}",
        new { @class = "form-control", type = "date" })
    @Html.ValidationMessageFor(model => model.DOB)
</div>

<!-- ✅ STATUS DROPDOWN -->
<div class="form-group">
    <label>Status</label>
    @Html.DropDownListFor(
        model => model.IsActive,
        Model.StatusList,
        "-- Select Status --",
        new { @class = "form-control" }
        )
    @Html.ValidationMessageFor(model => model.IsActive)
</div>

<br />

<button type="submit" class="btn btn-primary">Update</button>
<a href="@Url.Action("Index", "Employee")" class="btn btn-secondary">Cancel</a>
}


 *@



@model EmployeeModel

@using (Html.BeginForm("Edit", "Employee", FormMethod.Post, new { id = "editEmployeeForm" }))
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(model => model.Id)

    <div class="form-group mb-3">
        <label>Full Name</label>
        @Html.TextBoxFor(model => model.FullName, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.FullName, "", new { @class = "text-danger" })
    </div>

    <div class="form-group mb-3">
        <label>Employee ID</label>
        @Html.TextBoxFor(model => model.EmployeeId, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.EmployeeId, "", new { @class = "text-danger" })
    </div>

    <div class="form-group mb-3">
        <label>Email</label>
        @Html.TextBoxFor(model => model.Email, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.Email, "", new { @class = "text-danger" })
    </div>

    <div class="form-group mb-3">
        <label>Designation</label>
        @Html.TextBoxFor(model => model.Designation, new { @class = "form-control" })
        @Html.ValidationMessageFor(model => model.Designation, "", new { @class = "text-danger" })
    </div>

    <div class="form-group mb-3">
        <label>Date of Birth</label>
        @Html.TextBoxFor(model => model.DOB, "{0:yyyy-MM-dd}",
        new { @class = "form-control", type = "date" })
    @Html.ValidationMessageFor(model => model.DOB, "", new { @class = "text-danger" })
</div>

<div class="form-group mb-3">
    <label>Status</label>
    @Html.DropDownListFor(
        model => model.IsActive,
        Model.StatusList,
        "-- Select Status --",
        new { @class = "form-control" }
        )
    @Html.ValidationMessageFor(model => model.IsActive, "", new { @class = "text-danger" })
</div>

<div class="d-flex justify-content-end gap-2 mt-4">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
    <button type="submit" class="btn btn-primary">Update</button>
</div>
}

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>

<script>
    $(document).ready(function() {
        $('#editEmployeeForm').submit(function(e) {
            e.preventDefault();

            if (!$(this).valid()) {
                return false;
            }

            $.ajax({
                url: $(this).attr('action'),
                type: 'POST',
                data: $(this).serialize(),
                headers: { 'X-Requested-With': 'XMLHttpRequest' },
                success: function(result) {
                    if (result.success) {
                        // Close modal
                        var modal = bootstrap.Modal.getInstance(document.getElementById('editEmployeeModal'));
                        modal.hide();

                        // Show success message
                        alert(result.message);

                        // Reload page to show updated data
                        location.reload();
                    } else {
                        // Reload form with validation errors
                        $('#editModalBody').html(result);
                    }
                },
                error: function() {
                    alert('Error updating employee');
                }
            });
        });
    });
</script>